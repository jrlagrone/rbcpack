<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Numerical Results &#8212; RBCPack  documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Related Publications" href="pubs.html" />
    <link rel="prev" title="2D Klein-Gordon with a Corner" href="2d_kg_matlab.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          rbcpack</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Components <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Yee/FDTD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#downloads-and-respository">Downloads and Respository</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#acknowledgments">Acknowledgments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/index.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/index.html#optimal-cosines">Optimal Cosines</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contrib.html">rbcpack Contributors</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Current Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Numerical Results</a><ul>
<li><a class="reference internal" href="#solutions">Solutions</a><ul>
<li><a class="reference internal" href="#d-solution">2D solution</a></li>
<li><a class="reference internal" href="#derivation-of-a-3d-solution">Derivation of a 3D solution</a><ul>
<li><a class="reference internal" href="#satisfying-boundary-conditions">Satisfying Boundary Conditions</a></li>
<li><a class="reference internal" href="#implementation-detail">Implementation Detail</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#free-space-transverse-magnetic-problem">Free Space Transverse Magnetic Problem</a></li>
<li><a class="reference internal" href="#transverse-magnetic-in-a-wave-guide">Transverse Magnetic in a Wave Guide</a></li>
<li><a class="reference internal" href="#d-wave-guide">3D Wave Guide</a></li>
<li><a class="reference internal" href="#parallel-plates">Parallel Plates</a></li>
<li><a class="reference internal" href="#free-space">Free Space</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="2d_kg_matlab.html" title="Previous Chapter: 2D Klein-Gordon with a Corner"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 2D Klein-Gord...</span>
    </a>
  </li>
  <li>
    <a href="pubs.html" title="Next Chapter: Related Publications"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Related Publications &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Yee/FDTD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#downloads-and-respository">Downloads and Respository</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#licensing">Licensing</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#documentation">Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#user-guides">User Guides</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#known-issues">Known Issues</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#theory-results-and-publications">Theory, Results, and Publications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#acknowledgments">Acknowledgments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/index.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/index.html#optimal-cosines">Optimal Cosines</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contrib.html">rbcpack Contributors</a></li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="numerical-results">
<h1>Numerical Results<a class="headerlink" href="#numerical-results" title="Permalink to this headline">¶</a></h1>
<div class="section" id="solutions">
<span id="id1"></span><h2>Solutions<a class="headerlink" href="#solutions" title="Permalink to this headline">¶</a></h2>
<p>In order to test our method, we will construct exact solutions to Maxwell’s
Equations that satisfy our assumptions.
Namely, we wish to construct solution that satisfies the divergence free constraint
that is, at least numerically, compactly supported.</p>
<div class="section" id="d-solution">
<h3>2D solution<a class="headerlink" href="#d-solution" title="Permalink to this headline">¶</a></h3>
<p>We use the solution to the transverse magnetic problem given by</p>
<div class="math notranslate nohighlight">
\begin{align}
    E_z = \mu \frac{\partial \phi}{\partial t}, \qquad H_x = -
    \frac{\partial \phi}{\partial y}, \qquad H_y = \frac{\partial \phi}{\partial x},
\end{align}</div><p>where <span class="math notranslate nohighlight">\(\phi\)</span> is a solution of the scalar wave equation produced
by a point source with the time amplitude <span class="math notranslate nohighlight">\(e^{-125(t + .475)^2}\)</span>.
This solution is computed numerically to at least 10 digits. An end-point corrected
quadrature scheme to deal with the singularity in the Green’s function for the
wave equation in 2D. Boundary conditions are satisfied using the method of images.</p>
</div>
<div class="section" id="derivation-of-a-3d-solution">
<h3>Derivation of a 3D solution<a class="headerlink" href="#derivation-of-a-3d-solution" title="Permalink to this headline">¶</a></h3>
<p>If we choose <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> to be a solution to the wave equation with speed
<span class="math notranslate nohighlight">\(c = \frac{1}{\sqrt{\varepsilon \mu}}\)</span>, then we can ensure that our
solution is divergence free by defining</p>
<div class="math notranslate nohighlight">
\begin{align}
  \mathbf{A} = \nabla \times \mathbf{W} =
  \begin{bmatrix}
    \frac{\partial w_3}{\partial y} - \frac{\partial w_2}{\partial z} \\
    -\frac{\partial w_1}{\partial z} + \frac{\partial w_3}{\partial x} \\
    \frac{\partial w_1}{\partial y} - \frac{\partial w_2}{\partial x}
  \end{bmatrix}\label{curl_we}.
\end{align}</div><p>Then, we can define</p>
<div class="math notranslate nohighlight">
\begin{align}
  \mathbf{E} &amp;= -\mu \frac{\partial A}{\partial t} = - \mu (\nabla \times \mathbf{W}_t) ,\label{E_def} \\
  \mathbf{H} &amp;= \nabla \times A \label{H_def}.
\end{align}</div><p>Since <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> satisfies the wave equation by assumption, we have</p>
<div class="math notranslate nohighlight">
\begin{align}
  \mathbf{A}_{tt} = \frac{1}{\varepsilon \mu} \nabla^2 \mathbf{A},
\end{align}</div><p>therefore,</p>
<div class="math notranslate nohighlight">
\begin{align}
  \mathbf{E}_t = - \mu (\nabla \times \mathbf{A}_{tt}) = -\frac{1}{\varepsilon}  (\nabla \times \nabla^2 \mathbf{A}).
\end{align}</div><p>Using the vector identity
<span class="math notranslate nohighlight">\(\nabla^2 \mathbf{A} = \nabla (\nabla \cdot \mathbf{A}) - \nabla \times (\nabla \times \mathbf{A})\)</span>,
we have</p>
<div class="math notranslate nohighlight">
\begin{align}
  \mathbf{E}_t &amp; = - \frac{1}{\varepsilon} (\nabla \times (\nabla (\nabla \cdot \mathbf{A})))
                + \frac{1}{\varepsilon} (\nabla \times (\nabla \times A)) \\
  &amp; = \frac{1}{\varepsilon}(\nabla \times \mathbf{H}).
\end{align}</div><p>Similarly, we have</p>
<div class="math notranslate nohighlight">
\begin{align}
  \mathbf{H}_t = \nabla \times \mathbf{A}_{t} = - \frac{1}{\mu} (\nabla \times \mathbf{E}),
\end{align}</div><p>So we see Maxwell’s equations are satisfied. Furthermore, we can guarantee that
our solution is compactly supported, as desired, with a careful choice of <span class="math notranslate nohighlight">\(\mathbf{W}\)</span>.</p>
<div class="section" id="satisfying-boundary-conditions">
<h4>Satisfying Boundary Conditions<a class="headerlink" href="#satisfying-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>We can satisfy boundary conditions using the method of images.
To illustrate this, we want consider the 3D waveguide problem in the domain</p>
<div class="math notranslate nohighlight">
\begin{align}
  -\infty &amp;&lt; x &lt; \infty, \\
  0 &amp;&lt; y &lt; y_{max}, \\
  0 &amp;&lt; z &lt; z_{max},
\end{align}</div><p>with PEC boundary conditions at <span class="math notranslate nohighlight">\(y = 0\)</span>, <span class="math notranslate nohighlight">\(y = a\)</span>, <span class="math notranslate nohighlight">\(z = 0\)</span>, and
<span class="math notranslate nohighlight">\(z = b\)</span>.</p>
<p>In order to satisfy the PEC boundary conditions at <span class="math notranslate nohighlight">\(z=0\)</span> and
<span class="math notranslate nohighlight">\(z=z_{max}\)</span>, we have</p>
<div class="math notranslate nohighlight">
\begin{align}
  \hat{\mathbf{n}} \times \mathbf{E} = -\frac{\partial}{\partial t}
  \begin{bmatrix}
    \frac{\partial w_1}{\partial z} - \frac{\partial w_3}{\partial x} \\
    \frac{\partial w_3}{\partial y} - \frac{\partial w_2}{\partial z} \\
    0
  \end{bmatrix},
\end{align}</div><p>therefore, we require <span class="math notranslate nohighlight">\(w_1\)</span> to be even in <span class="math notranslate nohighlight">\(z\)</span>, <span class="math notranslate nohighlight">\(w_2\)</span> to be
even in z, and <span class="math notranslate nohighlight">\(w_3\)</span> to be odd in <span class="math notranslate nohighlight">\(z\)</span>. Similarly, we have</p>
<div class="math notranslate nohighlight">
\begin{align}
  \hat{\mathbf{n}} \times \mathbf{E} = -\frac{\partial}{\partial t}
  \begin{bmatrix}
    \frac{\partial w_1}{\partial y} - \frac{\partial w_2}{\partial x} \\
    0 \\
    \frac{-\partial w_3}{\partial y} + \frac{\partial w_2}{\partial z}
  \end{bmatrix},
\end{align}</div><p>for the PEC boundary conditions at <span class="math notranslate nohighlight">\(y=0\)</span> and <span class="math notranslate nohighlight">\(y=y_{max}\)</span>,
so we will require <span class="math notranslate nohighlight">\(w_1\)</span> to be even in <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(w_2\)</span> to be odd in
<span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(w_3\)</span> to be even in <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>Finally, given a source location we can enforce these conditions by adding
images of the appropriate source components (with the appropriate signs) which
have been reflected across the boundaries.</p>
</div>
<div class="section" id="implementation-detail">
<h4>Implementation Detail<a class="headerlink" href="#implementation-detail" title="Permalink to this headline">¶</a></h4>
<p>In the implementation of out test problems, we choose all three components of
<span class="math notranslate nohighlight">\(\mathbf{W}\)</span> to be</p>
<div class="math notranslate nohighlight">
\begin{align}
  w \equiv w_1 = w_2 = w_3 = \frac{e^{-\gamma (t + \tau - r)^2}}{r},
\end{align}</div><p>where <span class="math notranslate nohighlight">\(r = \sqrt{(x_1-x_{1_{src}})^2 + (x_2-x_{2_{src}})^2 +(x_3-x_{3_{src}})^2}\)</span>
and <span class="math notranslate nohighlight">\(\tau &gt; 0\)</span>.
It is easy to verify that this is a point source solution of the wave equation.
Noting that <span class="math notranslate nohighlight">\(e^{-36} \approx 2.3195 \cdot 10^{-16}\)</span>, we can derive approximate
bounds for the minimum and maximum distances the image sources can be from a given
point and contribute to the solution at that point.
Based on the chosen form, numerically, we will see no contributions if
the following is true</p>
<div class="math notranslate nohighlight">
\begin{align}
  \left| t + \tau -r \right| \sqrt{\gamma} &gt; 6.
\end{align}</div><p>This implies that we only need to consider the image sources in the region given
by</p>
<div class="math notranslate nohighlight">
\begin{align}
  t + \tau - \frac{6}{\sqrt{\gamma}} &lt; r &lt; t + \tau + \frac{6}{\sqrt{\gamma}}.
\end{align}</div><p>In practice, we first generate possible source locations in the looser bounds
given by inscribing a box in the lower bound and inscribing the upper bound in a box.
After generating the possible locations, we then check these possibilities against
the bound and only keep the sources that contribute.</p>
<p>When using this routine to generate initial conditions for simulations using the
Yee scheme, we compute the curl numerically using the same discrete curl operator
that is used in the Yee updates.
This gives us initial conditions that are numerically divergence free for the
simulations.
Furthermore, comparing the initial conditions computed using the
discrete and analytical divergence operators gives us a good approximation
of the discretization error we expect in the simulations.</p>
</div>
</div>
</div>
<div class="section" id="free-space-transverse-magnetic-problem">
<h2>Free Space Transverse Magnetic Problem<a class="headerlink" href="#free-space-transverse-magnetic-problem" title="Permalink to this headline">¶</a></h2>
<p>We simulated the free space transverse magnetic problem given by</p>
<div class="math notranslate nohighlight">
\begin{align}
  E_z = \mu \frac{\partial \phi}{\partial t}, \qquad H_x = -
        \frac{\partial \phi}{\partial y}, \qquad H_y = \frac{\partial \phi}{\partial x},
\end{align}</div><p>where <span class="math notranslate nohighlight">\(\phi\)</span> is a solution of the scalar wave equation produced
by a point source centered at <span class="math notranslate nohighlight">\((0, 0)\)</span> with the time amplitude
<span class="math notranslate nohighlight">\(e^{-125(t + .475)^2}\)</span>.
The CRBC/DAB boundaries were placed at <span class="math notranslate nohighlight">\(x=\pm 1\)</span> and <span class="math notranslate nohighlight">\(y=\pm 1\)</span>.
For this test, we used a grid size of <span class="math notranslate nohighlight">\(3000 \times 3000\)</span> in the <span class="math notranslate nohighlight">\(E_z\)</span>
component.
The errors reported are relative to the initial condition and
are given by the following formula</p>
<div class="math notranslate nohighlight">
\begin{align}
  \text{Relative Error at } t_n = \sqrt{\frac{\varepsilon \left\|
     \mathbf{E}_{\text{approx}}^{n} - \mathbf{E}_  {\text{exact}}^{n} \right\|^2_2
     + \mu \left\| \mathbf{H}_{\text{approx}}^{n} - \mathbf{H}_{\text{exact}}^{n}
     \right\|^2_2}{\varepsilon \left\| \mathbf{E}_{\text{exact}}^{0} \right\|^2_2
     + \mu \left\|  \mathbf{H}_{\text{exact}}^{0} \right\|^2_2}}
\end{align}</div><p>For comparison purposes we also ran the simulation using a convolution
PML (CPML) with suggested parameters from the literature. We note that it is
likely possible to find a set of parameters for the CPML that will perform better
than those presented for this problem. For these tests, we used a PML 10 Yee
cells thick and tried cubic and quartic ramping functions.</p>
<p>In the following plot showing <a class="reference internal" href="#fig-2d-free-short"><span class="std std-ref">behavior at short times</span></a>, we can  see that
it is possible to get comparable results for both the CRBC/DAB
boundaries and the CPML boundaries, depending on the chosen parameters.
In the following plot showing <a class="reference internal" href="#fig-2d-free-long"><span class="std std-ref">behavior at long times</span></a>, it appears that
the both boundaries have practically identical behaviors.</p>
<div class="figure align-center" id="id2" style="width: 60%">
<span id="fig-2d-free-short"></span><a class="reference internal image-reference" href="../_images/2d_free_short.png"><img alt="plot of relative error at short times" src="../_images/2d_free_short.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">behavior at short times</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error in Free Space for the Transverse Magnetic Test Problem.</p>
</div>
</div>
<div class="figure align-center" id="id3" style="width: 60%">
<span id="fig-2d-free-long"></span><a class="reference internal image-reference" href="../_images/2d_free_long.png"><img alt="plot of relative error at long times" src="../_images/2d_free_long.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">behavior at long times</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error in Free Space for the Transverse Magnetic Test Problem.</p>
</div>
</div>
<p>Finally, the following table summarizes the simulation results.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 29%" />
<col style="width: 14%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Grid</p></th>
<th class="head"><p>DOFs</p></th>
<th class="head"><p>BC</p></th>
<th class="head"><p>Max Rel Err</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(3000 \times 3000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2.72 \times 10^{7}\)</span></p></td>
<td><p>CRBC P = 5</p></td>
<td><p><span class="math notranslate nohighlight">\(3.73 \times 10^{-4}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(3000 \times 3000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2.73 \times 10^{7}\)</span></p></td>
<td><p>CRBC P = 9</p></td>
<td><p><span class="math notranslate nohighlight">\(2.76 \times 10^{-5}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(3020 \times 3020\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2.77 \times 10^{7}\)</span></p></td>
<td><p>Cubic PML</p></td>
<td><p><span class="math notranslate nohighlight">\(2.76 \times 10^{-5}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(3020 \times 3020\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2.77 \times 10^{7}\)</span></p></td>
<td><p>Quartic PML</p></td>
<td><p><span class="math notranslate nohighlight">\(2.80 \times 10^{-5}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="transverse-magnetic-in-a-wave-guide">
<h2>Transverse Magnetic in a Wave Guide<a class="headerlink" href="#transverse-magnetic-in-a-wave-guide" title="Permalink to this headline">¶</a></h2>
<p>To test these boundary conditions, we again simulated the transverse magnetic
problem given by</p>
<div class="math notranslate nohighlight">
 \begin{align}
   E_z = \mu \frac{\partial \phi}{\partial t}, \qquad H_x = - \frac{\partial \phi}{\partial y},
     \qquad H_y = \frac{\partial \phi}{\partial x},
 \end{align}</div><p>where <span class="math notranslate nohighlight">\(\phi\)</span> is a solution of the scalar wave equation satisfying
zero Dirichlet (PEC) boundary conditions at <span class="math notranslate nohighlight">\(y=0\)</span> and <span class="math notranslate nohighlight">\(y=1\)</span> produced
by a point source centered at <span class="math notranslate nohighlight">\((0, 0.1)\)</span> with a time
amplitude <span class="math notranslate nohighlight">\(e^{-125(t + .475)^2 }\)</span>.
The CRBC/DAB and PML boundaries were placed at <span class="math notranslate nohighlight">\(x=\pm 1\)</span> and the grid was
<span class="math notranslate nohighlight">\(6000 \times 3000\)</span> in the <span class="math notranslate nohighlight">\(E_z\)</span> component.</p>
<p>The errors reported are relative to the initial condition and
are given by the following formula</p>
<div class="math notranslate nohighlight">
\begin{align}
   \text{Relative Error at } t_n = \sqrt{\frac{\varepsilon \left\|
     \mathbf{E}_{\text{approx}}^{n} - \mathbf{E}_  {\text{exact}}^{n} \right\|^2_2
     + \mu \left\| \mathbf{H}_{\text{approx}}^{n} - \mathbf{H}_{\text{exact}}^{n}
     \right\|^2_2}{\varepsilon \left\| \mathbf{E}_{\text{exact}}^{0} \right\|^2_2
     + \mu \left\|  \mathbf{H}_{\text{exact}}^{0} \right\|^2_2}}
\end{align}</div><p>For comparison purposes we also ran the simulation using a convolution
PML (CPML) with suggested parameters from the literature. We note that it is
likely possible to find a set of parameters for the CPML that will perform better
than those presented for this problem. For these tests, we used a PML 10 Yee
cells thick and tried cubic and quartic ramping functions. The final run
labeled “PML” corresponds to choosing the PML parameter <span class="math notranslate nohighlight">\(\sigma_{max}\)</span> to be
approximately twice as large as suggested with quartic ramping.</p>
<p>In <a class="reference internal" href="#fig-2d-wg"><span class="std std-ref">2D waveguide plot</span></a>, we see that the DAB boundaries perform much better than the PML.
Furthermore, we see that suggested parameter values for the PML sometimes perform
poorly.</p>
<div class="figure align-center" id="id4" style="width: 60%">
<span id="fig-2d-wg"></span><a class="reference internal image-reference" href="../_images/2d_wg.png"><img alt="plot of relative error" src="../_images/2d_wg.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">2D waveguide plot</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for the Transverse Magnetic Test Problem in a Wave Guide.</p>
</div>
</div>
<p>Finally, the following table summarizes the simulation results.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 29%" />
<col style="width: 14%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Grid</p></th>
<th class="head"><p>DOFs</p></th>
<th class="head"><p>BC</p></th>
<th class="head"><p>Max Rel Err</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(6000 \times 3000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6.01 \times 10^{7}\)</span></p></td>
<td><p>CRBC P = 5</p></td>
<td><p><span class="math notranslate nohighlight">\(3.52 \times 10^{-4}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(6000 \times 3000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6.02 \times 10^{7}\)</span></p></td>
<td><p>CRBC P = 9</p></td>
<td><p><span class="math notranslate nohighlight">\(1.94 \times 10^{-4}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(6020 \times 3000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6.04 \times 10^{7}\)</span></p></td>
<td><p>PML</p></td>
<td><p><span class="math notranslate nohighlight">\(3.37 \times 10^{-2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(6020 \times 3000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6.04 \times 10^{7}\)</span></p></td>
<td><p>Cubic PML</p></td>
<td><p><span class="math notranslate nohighlight">\(1.34 \times 10^{-1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(6020 \times 3000\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(6.04 \times 10^{7}\)</span></p></td>
<td><p>Quartic PML</p></td>
<td><p><span class="math notranslate nohighlight">\(1.33 \times 10^{-1}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="d-wave-guide">
<h2>3D Wave Guide<a class="headerlink" href="#d-wave-guide" title="Permalink to this headline">¶</a></h2>
<p>Using a solution generated from a point source solution to the wave equation
with a Gaussian time amplitude as described in the <a class="reference internal" href="#solutions"><span class="std std-ref">solutions section</span></a>, we have tested our implementation
of the DAB boundaries on the domain <span class="math notranslate nohighlight">\([0,1.6] \times [0,1.6] \times [0,1.6]\)</span> with DAB
boundaries at <span class="math notranslate nohighlight">\(x = 0\)</span> and <span class="math notranslate nohighlight">\(x =1.6\)</span> and PEC boundaries elsewhere.
The source location was <span class="math notranslate nohighlight">\(( 0.8, 0.8, 0.8)\)</span> and we used the solution parameters
<span class="math notranslate nohighlight">\(\tau = 0.39\)</span> and <span class="math notranslate nohighlight">\(\gamma = 130\)</span> with material parameters <span class="math notranslate nohighlight">\(\epsilon = 0.8\)</span> and <span class="math notranslate nohighlight">\(\mu = 1.25\)</span>.
The simulations were run with the CRBC parameter <span class="math notranslate nohighlight">\(P = 3\)</span> and <span class="math notranslate nohighlight">\(P = 5\)</span> on a grid with <span class="math notranslate nohighlight">\(n\)</span> Yee
cells in each spatial direction.</p>
<p>For the <span class="math notranslate nohighlight">\(P = 3\)</span> case, we can see that we stay below the reflection coefficient for about a third of the simulation
in the <a class="reference internal" href="#fig-3d-wg-3"><span class="std std-ref">3D waveguide plot (P = 3)</span></a>.
For the <span class="math notranslate nohighlight">\(P = 5\)</span> case, we see approximately the same behavior as the <span class="math notranslate nohighlight">\(P = 3\)</span>
case in the <a class="reference internal" href="#fig-3d-wg-5"><span class="std std-ref">3D waveguide plot (P = 5)</span></a>.
This behavior indicates that the discretization error is dominant in most cases and we believe the error at
later times can be explained by numerical dispersion.</p>
<div class="figure align-center" id="id5" style="width: 60%">
<span id="fig-3d-wg-3"></span><a class="reference internal image-reference" href="../_images/wg_long_p=3.png"><img alt="plot of relative error" src="../_images/wg_long_p=3.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D waveguide plot (P = 3)</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D wave guide simulation and and the expected reflection coefficients.</p>
</div>
</div>
<div class="figure align-center" id="id6" style="width: 60%">
<span id="fig-3d-wg-5"></span><a class="reference internal image-reference" href="../_images/wg_long_p=5.png"><img alt="plot of relative error" src="../_images/wg_long_p=5.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D waveguide plot (P = 5)</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D wave guide simulation and and the expected reflection coefficients.</p>
</div>
</div>
</div>
<div class="section" id="parallel-plates">
<h2>Parallel Plates<a class="headerlink" href="#parallel-plates" title="Permalink to this headline">¶</a></h2>
<p>Using a solution generated from a point source solution to the wave equation
with a Gaussian time amplitude as described in the <a class="reference internal" href="#solutions"><span class="std std-ref">solutions section</span></a>, we have tested our implementation
of the DAB boundaries on the domain <span class="math notranslate nohighlight">\([0,1.6] \times [0,1.6] \times [0,1.6]\)</span> with PEC
boundaries at <span class="math notranslate nohighlight">\(z = 0\)</span> and <span class="math notranslate nohighlight">\(z =1.6\)</span> and DAB boundaries elsewhere.
The source location was <span class="math notranslate nohighlight">\(( 0.8, 0.8, 0.8)\)</span> and we used the solution parameters
<span class="math notranslate nohighlight">\(\tau = 0.39\)</span> and <span class="math notranslate nohighlight">\(\gamma = 130\)</span> with material parameters <span class="math notranslate nohighlight">\(\epsilon = 0.8\)</span> and <span class="math notranslate nohighlight">\(\mu = 1.25\)</span>.
The simulations were run with the CRBC parameter <span class="math notranslate nohighlight">\(P = 3\)</span> and <span class="math notranslate nohighlight">\(P = 5\)</span> on a grid with <span class="math notranslate nohighlight">\(n\)</span> Yee
cells in each spatial direction.</p>
<p>Similar to the wave guide case, for the <span class="math notranslate nohighlight">\(P = 3\)</span> case, we can see that we
stay below the reflection coefficient when using a sufficiently refined grid
in the <a class="reference internal" href="#fig-3d-par-3"><span class="std std-ref">3D parallel plates plot (P = 3)</span></a>.
For the <span class="math notranslate nohighlight">\(P = 5\)</span> case, we again see approximately the same behavior as the <span class="math notranslate nohighlight">\(P = 3\)</span>
case in the <a class="reference internal" href="#fig-3d-par-5"><span class="std std-ref">3D parallel plates plot (P = 5)</span></a>.
This behavior indicates that the discretization error is dominant in most cases.
Compared to the wave guide example, the better long time error behavior is due
to the fact that more energy leaves the computational domain and the numerical
dispersion has less effect.</p>
<div class="figure align-center" id="id7" style="width: 60%">
<span id="fig-3d-par-3"></span><a class="reference internal image-reference" href="../_images/par_long_p=3.png"><img alt="plot of relative error" src="../_images/par_long_p=3.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D parallel plates plot (P = 3)</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D parallel plate simulation and and the expected reflection coefficients.</p>
</div>
</div>
<div class="figure align-center" id="id8" style="width: 60%">
<span id="fig-3d-par-5"></span><a class="reference internal image-reference" href="../_images/par_long_p=5.png"><img alt="plot of relative error" src="../_images/par_long_p=5.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D parallel plates plot (P = 5)</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D parallel plate simulation and and the expected reflection coefficients.</p>
</div>
</div>
</div>
<div class="section" id="free-space">
<h2>Free Space<a class="headerlink" href="#free-space" title="Permalink to this headline">¶</a></h2>
<p>Again, using a solution generated from a point source solution to the wave equation
with a Gaussian time amplitude as described in the <a class="reference internal" href="#solutions"><span class="std std-ref">solutions section</span></a>, we have tested our implementation
of the DAB boundaries on the domain <span class="math notranslate nohighlight">\([0,1.6] \times [0,1.6] \times [0,1.6]\)</span> with DAB boundaries one all faces.
The source location was <span class="math notranslate nohighlight">\(( 0.8, 0.8, 0.8)\)</span> and we used the solution parameters
<span class="math notranslate nohighlight">\(\tau = 0.39\)</span> and <span class="math notranslate nohighlight">\(\gamma = 130\)</span> with material parameters <span class="math notranslate nohighlight">\(\epsilon = 0.8\)</span> and <span class="math notranslate nohighlight">\(\mu = 1.25\)</span>.
The simulations were run with the CRBC parameter <span class="math notranslate nohighlight">\(P = 3\)</span> and <span class="math notranslate nohighlight">\(P = 5\)</span> on a grid with <span class="math notranslate nohighlight">\(n\)</span> Yee
cells in each spatial direction.</p>
<p>For the free space simulation, we see that we are able to meet the error bounds provided by the
expected reflection coefficients up to <span class="math notranslate nohighlight">\(P=7\)</span>.
Looking at the <a class="reference internal" href="#fig-3d-free-3"><span class="std std-ref">3D free space plot (P = 3)</span></a>, we can see that relative error “steps” down
in a more or less regular pattern. This happens because some amount of the wave
front erroneously reflects off of the boundary and a large portion of this reflected
wave is absorbed when it reaches the opposite boundary.
We can see this behavior in the <a class="reference internal" href="#fig-3d-free-5"><span class="std std-ref">3D free space plot (P = 5)</span></a> and the <a class="reference internal" href="#fig-3d-free-7"><span class="std std-ref">3D free space plot (P = 7)</span></a>
and we note that in all of these cases the reflection coefficient is a good
predictor of where this behavior occurs, as expected.
In the <a class="reference internal" href="#fig-3d-free-9"><span class="std std-ref">3D free space plot (P = 9)</span></a>, we see that the discretization error dominates
and we never reach the reflection coefficient.
Finally, in the <a class="reference internal" href="#fig-3d-free-7-long"><span class="std std-ref">3D free space plot (long time, P = 7)</span></a>, we show that relative error remains constant
over a long time (this occurs for all of the simulations, but we have omitted the
plots).
In these simulations, we believe the long time error are on the order of discretization error.</p>
<p>These plots also demonstrate that choosing the a tolerance so that a reflection
coefficient is approximately equal to the discretization error is a good choice.
For instance, we can see that <span class="math notranslate nohighlight">\(P=5\)</span> is a good choice for <span class="math notranslate nohighlight">\(n=112\)</span> and
<span class="math notranslate nohighlight">\(p=7\)</span> is a good choice for <span class="math notranslate nohighlight">\(n=450\)</span>.</p>
<div class="figure align-center" id="id9" style="width: 60%">
<span id="fig-3d-free-3"></span><a class="reference internal image-reference" href="../_images/free_short_p=3.png"><img alt="plot of relative error" src="../_images/free_short_p=3.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D free space plot (P = 3)</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D free space simulation and the expected reflection coefficients.</p>
</div>
</div>
<div class="figure align-center" id="id10" style="width: 60%">
<span id="fig-3d-free-5"></span><a class="reference internal image-reference" href="../_images/free_short_p=5.png"><img alt="plot of relative error" src="../_images/free_short_p=5.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D free space plot (P = 5)</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D free space simulation and the expected reflection coefficients.</p>
</div>
</div>
<div class="figure align-center" id="id11" style="width: 60%">
<span id="fig-3d-free-7"></span><a class="reference internal image-reference" href="../_images/free_short_p=7.png"><img alt="plot of relative error" src="../_images/free_short_p=7.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D free space plot (P = 7)</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D free space simulation and the expected reflection coefficients.</p>
</div>
</div>
<div class="figure align-center" id="id12" style="width: 60%">
<span id="fig-3d-free-9"></span><a class="reference internal image-reference" href="../_images/free_short_p=9.png"><img alt="plot of relative error" src="../_images/free_short_p=9.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D free space plot (P = 9)</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D free space simulation and the expected reflection coefficients.</p>
</div>
</div>
<div class="figure align-center" id="id13" style="width: 60%">
<span id="fig-3d-free-7-long"></span><a class="reference internal image-reference" href="../_images/free_long_p=7.png"><img alt="plot of relative error" src="../_images/free_long_p=7.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">3D free space plot (long time, P = 7)</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>Relative Error for a 3D free space simulation and the expected reflection coefficients.</p>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/YeeCRBC/results.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
    <a href="../contrib.html">rbcpack Contributors </a><br />
        &copy; Copyright 2015-2016, rbcpack.org.<br/>
    </p>
  </div>
</footer>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-71984541-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>
</html>