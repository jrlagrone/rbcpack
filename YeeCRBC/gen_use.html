<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>General Usage &#8212; RBCPack  documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Supported Problems" href="supported_problems.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          rbcpack</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Components <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Yee/FDTD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#downloads-and-respository">Downloads and Respository</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#acknowledgments">Acknowledgments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/index.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/index.html#optimal-cosines">Optimal Cosines</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contrib.html">rbcpack Contributors</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Current Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">General Usage</a><ul>
<li><a class="reference internal" href="#typical-work-flow">Typical Work Flow</a><ul>
<li><a class="reference internal" href="#procedure-for-calling-the-library">Procedure for Calling the Library</a><ul>
<li><a class="reference internal" href="#initializing-an-updater-object">Initializing an Updater Object</a></li>
<li><a class="reference internal" href="#initializing-boundary-faces">Initializing Boundary Faces</a></li>
<li><a class="reference internal" href="#copying-and-updating-values">Copying and Updating Values</a></li>
<li><a class="reference internal" href="#more-details">More Details</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#choice-of-parameters">Choice of Parameters</a><ul>
<li><a class="reference internal" href="#tolerance">Tolerance</a></li>
<li><a class="reference internal" href="#number-of-recursions">Number of Recursions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="supported_problems.html" title="Previous Chapter: Supported Problems"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Supported Problems</span>
    </a>
  </li>
  <li>
    <a href="examples.html" title="Next Chapter: Examples"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Examples &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">  <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Yee/FDTD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#downloads-and-respository">Downloads and Respository</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#licensing">Licensing</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#documentation">Documentation</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html#user-guides">User Guides</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#known-issues">Known Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#theory-results-and-publications">Theory, Results, and Publications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#acknowledgments">Acknowledgments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Utilities/index.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Utilities/index.html#optimal-cosines">Optimal Cosines</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contrib.html">rbcpack Contributors</a></li>
</ul>

<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-9 content" role="main">
      
  <div class="section" id="general-usage">
<h1>General Usage<a class="headerlink" href="#general-usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="typical-work-flow">
<h2>Typical Work Flow<a class="headerlink" href="#typical-work-flow" title="Permalink to this headline">¶</a></h2>
<div class="section" id="procedure-for-calling-the-library">
<h3>Procedure for Calling the Library<a class="headerlink" href="#procedure-for-calling-the-library" title="Permalink to this headline">¶</a></h3>
<p>To use the library, the basic workflow is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                     <span class="o">-----------------------------</span>
                     <span class="o">|</span> <span class="n">initialize</span> <span class="n">updater</span> <span class="nb">object</span> <span class="o">|</span>
                     <span class="o">-----------------------------</span>
                                  <span class="o">|</span>
                                  <span class="n">v</span>
                     <span class="o">-----------------------------</span>
                     <span class="o">|</span> <span class="n">initialize</span> <span class="n">boundary</span> <span class="n">faces</span> <span class="o">|</span>
                     <span class="o">-----------------------------</span>
                                  <span class="o">|</span>
                                  <span class="n">v</span>
                             <span class="o">-------------</span>
         <span class="o">------------------&gt;</span> <span class="o">|</span> <span class="n">time</span> <span class="n">step</span> <span class="o">|--------------------</span>
         <span class="o">^</span>                   <span class="o">-------------</span>                   <span class="o">|</span>
         <span class="o">|</span>                                                   <span class="o">|</span>
         <span class="o">|</span>                                                   <span class="n">v</span>
<span class="o">---------------------</span>      <span class="o">-------------------</span>      <span class="o">---------------------</span>
<span class="o">|</span> <span class="n">copy</span> <span class="n">new</span> <span class="n">boundary</span> <span class="o">|</span>      <span class="o">|</span>  <span class="n">updater</span> <span class="nb">object</span> <span class="o">|</span>      <span class="o">|</span>  <span class="n">copy</span> <span class="n">new</span> <span class="n">values</span>  <span class="o">|</span>
<span class="o">|</span>  <span class="n">values</span> <span class="n">into</span> <span class="n">the</span>  <span class="o">|</span> <span class="o">&lt;----|</span>  <span class="n">computes</span> <span class="n">new</span>   <span class="o">|</span> <span class="o">&lt;----|</span>  <span class="n">into</span> <span class="n">the</span> <span class="n">updater</span> <span class="o">|</span>
<span class="o">|</span>      <span class="n">solver</span>       <span class="o">|</span>      <span class="o">|</span> <span class="n">boundary</span> <span class="n">values</span> <span class="o">|</span>      <span class="o">|</span>      <span class="nb">object</span>       <span class="o">|</span>
<span class="o">---------------------</span>      <span class="o">-------------------</span>      <span class="o">---------------------</span>
</pre></div>
</div>
<div class="section" id="initializing-an-updater-object">
<h4>Initializing an Updater Object<a class="headerlink" href="#initializing-an-updater-object" title="Permalink to this headline">¶</a></h4>
<p>To begin, a boundary updater object needs to be initialized. Currently, there
are three interfaces available: a 3D FDTD/Yee interface in C, a 2D interface in
C, and the underlying C++ interface. In all three cases, a boundary object is
created in a similar manner. Each interface has three initializers: one to use
the default number of recursions (which we have set to 5), one to set the number
of recursions to use to a specific number, and finally one that chooses the
number of recursions to use based on a provided tolerance.</p>
<p>In the 3D FDTD/Yee interface these initializers are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">updater</span> <span class="nb">object</span> <span class="k">with</span> <span class="n">default</span> <span class="n">settings</span>
<span class="n">YeeCrbcUpdater</span><span class="o">*</span> <span class="n">CRBC_new_updater</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="n">T</span><span class="p">,</span>
                                  <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                  <span class="n">const</span> <span class="n">CoefType</span> <span class="n">dt</span><span class="p">,</span>
                                  <span class="n">const</span> <span class="n">CoefType</span> <span class="n">c</span><span class="p">,</span>
                                  <span class="n">const</span> <span class="n">CRBC_Boundaries_t</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>

<span class="o">//</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">updater</span> <span class="nb">object</span> <span class="ow">and</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">recursions</span>
<span class="n">YeeCrbcUpdater</span><span class="o">*</span> <span class="n">CRBC_new_updater_p</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="n">T</span><span class="p">,</span>
                                    <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                    <span class="n">const</span> <span class="n">CoefType</span> <span class="n">dt</span><span class="p">,</span>
                                    <span class="n">const</span> <span class="n">CoefType</span> <span class="n">c</span><span class="p">,</span>
                                    <span class="n">const</span> <span class="n">CRBC_Boundaries_t</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
                                    <span class="n">const</span> <span class="nb">int</span> <span class="n">P</span><span class="p">);</span>

<span class="o">//</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">updater</span> <span class="nb">object</span> <span class="ow">and</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">a</span> <span class="n">tolerance</span> <span class="k">for</span> <span class="n">the</span> <span class="n">recursions</span>
<span class="n">YeeCrbcUpdater</span><span class="o">*</span> <span class="n">CRBC_new_updater_tol</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="n">T</span><span class="p">,</span>
                                      <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                      <span class="n">const</span> <span class="n">CoefType</span> <span class="n">dt</span><span class="p">,</span>
                                      <span class="n">const</span> <span class="n">CoefType</span> <span class="n">c</span><span class="p">,</span>
                                      <span class="n">const</span> <span class="n">CRBC_Boundaries_t</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
                                      <span class="n">const</span> <span class="nb">int</span> <span class="n">Pmax</span><span class="p">,</span>
                                      <span class="n">const</span> <span class="n">double</span> <span class="n">tol</span><span class="p">);</span>
</pre></div>
</div>
<p>Where the return type is provided by the library and is simply defined as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">YeeCrbcUpdater</span><span class="p">;</span>
<span class="n">typedef</span> <span class="n">struct</span> <span class="n">YeeCrbcUpdater</span> <span class="n">YeeCrbcUpdater</span><span class="p">;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">CoefType</span></code> is defined when the library is compiled and can either be
<code class="docutils literal notranslate"><span class="pre">double</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code> for the C interfaces and is a template parameter for the
C++ interfaces. Finally the <code class="docutils literal notranslate"><span class="pre">CRBC_Boundaries_t</span></code> is an enumeration
type provided by the library defined</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">enum</span> <span class="n">CRBC_Side</span> <span class="p">{</span>
  <span class="n">CRBC_XLeft</span><span class="p">,</span>  <span class="o">/**&lt;</span> <span class="n">Left</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">x</span><span class="o">-</span><span class="n">coordinate</span> <span class="n">direction</span> <span class="o">*/</span>
  <span class="n">CRBC_XRight</span><span class="p">,</span> <span class="o">/**&lt;</span> <span class="n">Right</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">x</span><span class="o">-</span><span class="n">coordinate</span> <span class="n">direction</span> <span class="o">*/</span>
  <span class="n">CRBC_YLeft</span><span class="p">,</span>  <span class="o">/**&lt;</span> <span class="n">Left</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">y</span><span class="o">-</span><span class="n">coordinate</span> <span class="n">direction</span> <span class="o">*/</span>
  <span class="n">CRBC_YRight</span><span class="p">,</span> <span class="o">/**&lt;</span> <span class="n">Right</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">y</span><span class="o">-</span><span class="n">coordinate</span> <span class="n">direction</span> <span class="o">*/</span>
  <span class="n">CRBC_ZLeft</span><span class="p">,</span>  <span class="o">/**&lt;</span> <span class="n">Left</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">z</span><span class="o">-</span><span class="n">coordinate</span> <span class="n">direction</span> <span class="o">*/</span>
  <span class="n">CRBC_ZRight</span>  <span class="o">/**&lt;</span> <span class="n">Right</span> <span class="n">side</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">z</span><span class="o">-</span><span class="n">coordinate</span> <span class="n">direction</span> <span class="o">*/</span>
<span class="p">}</span> <span class="n">CRBC_Side_t</span><span class="p">;</span>
</pre></div>
</div>
<p>The 2D interface is almost exactly the same:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">updater</span> <span class="nb">object</span> <span class="k">with</span> <span class="n">default</span> <span class="n">settings</span>
<span class="n">CrbcUpdater2d</span><span class="o">*</span> <span class="n">CRBC2d_new_updater</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="n">T</span><span class="p">,</span>    <span class="o">//</span> <span class="n">total</span> <span class="n">time</span>
                                   <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">//</span> <span class="n">grid</span> <span class="n">spacings</span>
                                   <span class="n">const</span> <span class="n">CoefType</span> <span class="n">dt</span><span class="p">,</span>   <span class="o">//</span> <span class="n">time</span> <span class="n">step</span>
                                   <span class="n">const</span> <span class="n">CoefType</span> <span class="n">c</span><span class="p">,</span>    <span class="o">//</span> <span class="n">wave</span> <span class="n">speed</span>
                                   <span class="n">const</span> <span class="n">CRBC2d_Boundaries_t</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>

<span class="o">//</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">updater</span> <span class="nb">object</span> <span class="ow">and</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">recursions</span>
<span class="n">CrbcUpdater2d</span><span class="o">*</span> <span class="n">CRBC2d_new_updater_p</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="n">T</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                     <span class="n">const</span> <span class="n">CoefType</span> <span class="n">dt</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">CoefType</span> <span class="n">c</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">CRBC2d_Boundaries_t</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                                     <span class="n">const</span> <span class="nb">int</span> <span class="n">P</span><span class="p">);</span>

<span class="o">//</span>  <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">updater</span> <span class="nb">object</span> <span class="ow">and</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">a</span> <span class="n">tolerance</span> <span class="k">for</span> <span class="n">the</span> <span class="n">recursions</span>
<span class="n">CrbcUpdater2d</span><span class="o">*</span> <span class="n">CRBC2d_new_updater_tol</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="n">T</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                     <span class="n">const</span> <span class="n">CoefType</span> <span class="n">dt</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">CoefType</span> <span class="n">c</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">CRBC2d_Boundaries_t</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                                     <span class="n">const</span> <span class="nb">int</span> <span class="n">Pmax</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">double</span> <span class="n">tol</span><span class="p">);</span>
</pre></div>
</div>
<p>Finally, the C++ interface differs somewhat.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">///</span> <span class="n">Constructor</span> <span class="o">---</span> <span class="n">initialize</span> <span class="n">only</span> <span class="n">the</span> <span class="n">parameters</span> <span class="n">that</span> <span class="n">are</span> <span class="n">common</span> <span class="n">to</span> <span class="nb">all</span> <span class="n">of</span>
<span class="o">///</span> <span class="n">the</span> <span class="n">faces</span> <span class="ow">in</span> <span class="nb">all</span> <span class="n">circumstances</span><span class="o">.</span>
<span class="n">CrbcUpdates</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="n">DIM</span><span class="p">],</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">dt</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">Boundary</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">DIM</span><span class="p">]);</span>

<span class="o">///</span> <span class="n">Constructor</span> <span class="o">---</span> <span class="n">initialize</span> <span class="n">only</span> <span class="n">the</span> <span class="n">parameters</span> <span class="n">that</span> <span class="n">are</span> <span class="n">common</span> <span class="n">to</span> <span class="nb">all</span> <span class="n">of</span>
<span class="o">///</span> <span class="n">the</span> <span class="n">faces</span> <span class="ow">and</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">recursions</span> <span class="n">to</span> <span class="n">be</span> <span class="n">P</span> <span class="ow">in</span> <span class="nb">all</span> <span class="n">directions</span>
<span class="n">CrbcUpdates</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="n">DIM</span><span class="p">],</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">dt</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">Boundary</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">DIM</span><span class="p">],</span>
             <span class="n">const</span> <span class="nb">int</span> <span class="o">&amp;</span><span class="n">P</span><span class="p">);</span>

<span class="o">///</span> <span class="n">Constructor</span> <span class="o">---</span> <span class="n">initialize</span> <span class="n">only</span> <span class="n">the</span> <span class="n">parameters</span> <span class="n">that</span> <span class="n">are</span> <span class="n">common</span> <span class="n">to</span> <span class="nb">all</span> <span class="n">of</span>
<span class="o">///</span> <span class="n">the</span> <span class="n">faces</span> <span class="ow">and</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">recursions</span> <span class="n">to</span> <span class="n">be</span> <span class="n">calculated</span> <span class="n">based</span> <span class="n">on</span> <span class="n">the</span>
<span class="o">///</span> <span class="n">provided</span> <span class="n">tolerance</span>
<span class="n">CrbcUpdates</span> <span class="p">(</span><span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">T</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="n">h</span><span class="p">[</span><span class="n">DIM</span><span class="p">],</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">dt</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">CoefType</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">Boundary</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">DIM</span><span class="p">],</span>
             <span class="n">const</span> <span class="nb">int</span> <span class="o">&amp;</span><span class="n">Pmax</span><span class="p">,</span>
             <span class="n">const</span> <span class="n">double</span> <span class="o">&amp;</span><span class="n">tol</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="initializing-boundary-faces">
<h4>Initializing Boundary Faces<a class="headerlink" href="#initializing-boundary-faces" title="Permalink to this headline">¶</a></h4>
<p>The library requires that each of the boundary faces (or sides in 2D) are initialized
individually. We do this for a number of reasons, but the most important is the
fact that each boundary face may pose a different degree of difficulty.</p>
<p>On each face, the boundary updater expects to get two things. The first is the
parameter, <span class="math notranslate nohighlight">\(\delta\)</span>, which represents the separation from the boundary
face to any sources, scatterers, or other inhomogeneities. The second is
the data extents that will serve as in the inputs an outputs of the library.
In order to function correctly, these extents need to include all of the points
on the boundary as well as the parallel plane (or line in 2D) of points immediately
interior to the boundary.</p>
<p>For example, suppose we have a computational domain
with <span class="math notranslate nohighlight">\(n_x\)</span> grid points in the x-direction, <span class="math notranslate nohighlight">\(n_y\)</span> grid points in the
y-direction, and <span class="math notranslate nohighlight">\(n_z\)</span> grid points in the z-direction.
Then, if we want to set up the boundary face on the right side in the x-direction,
we will require all of the points on the boundary, which would be the points at
<span class="math notranslate nohighlight">\(i=n_x\)</span>, <span class="math notranslate nohighlight">\(j=1,...,n_y\)</span>, and <span class="math notranslate nohighlight">\(k=1,...,n_z\)</span> assuming the indexing
begins at one. Then we also need the parallel plane of points on the interior side
of this boundary, which are the points <span class="math notranslate nohighlight">\(i=n_x-1\)</span>, <span class="math notranslate nohighlight">\(j=1,...,n_y\)</span>,
and <span class="math notranslate nohighlight">\(k=1,...,n_z\)</span>.
Therefore, our indexing extents should be <span class="math notranslate nohighlight">\([n_x-1, n_x] \times [1, n_y] \times
[1, n_z]\)</span>. However, the library expects the lower extents to be in one array and
the upper extents to be in a second array, so are inputs should be
<span class="math notranslate nohighlight">\([n_x-1, 1, 1]\)</span> and <span class="math notranslate nohighlight">\([n_x, n_y , n_z]\)</span> for the lower and upper
extents, respectively. Note that the library considers these extents to be inclusive.</p>
<p>For the 3D Yee interface this same procedure needs to be applied all of the components
of the <strong>E</strong> field required to generate the boundary conditions. Note that the
library can provide a list of the components it expects by calling the function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">get</span> <span class="n">the</span> <span class="n">components</span> <span class="n">we</span> <span class="n">expect</span> <span class="n">to</span> <span class="n">be</span> <span class="n">inputted</span> <span class="n">into</span> <span class="n">the</span> <span class="n">updater</span>
<span class="n">void</span> <span class="n">CRBC_get_component_inputs</span> <span class="p">(</span><span class="n">YeeCrbcUpdater</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                         <span class="n">const</span> <span class="n">CRBC_Side_t</span> <span class="n">side</span><span class="p">,</span>
                         <span class="n">CRBC_Fields_t</span> <span class="o">*</span><span class="n">comp</span><span class="p">,</span>
                         <span class="nb">int</span> <span class="o">*</span><span class="n">n</span><span class="p">);</span>
</pre></div>
</div>
<p>The only odd thing here is the we sometimes require the normal <strong>E</strong> field component.
We note that this component is half of a grid space inside the boundary. In this
case, we require the plane of points closest to the boundary and the adjacent
parallel plane of points in the interior. These points are only needed as input
to update edges and corners.</p>
<p>In all three available interfaces, the function call to initialize the faces are
similar. The only practical difference is that in the 3D Yee interface, we also
need to know which component is being initialized.</p>
<p>In the 3D Yee interface, the call is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">initialize</span> <span class="n">a</span> <span class="n">component</span> <span class="n">on</span> <span class="n">a</span> <span class="n">face</span>
<span class="nb">int</span> <span class="n">CRBC_init_face</span> <span class="p">(</span><span class="n">YeeCrbcUpdater</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                    <span class="n">const</span> <span class="n">CRBC_Side_t</span> <span class="n">side</span><span class="p">,</span>
                    <span class="n">const</span> <span class="n">CRBC_Fields_t</span> <span class="n">comp</span><span class="p">,</span>
                    <span class="n">const</span> <span class="n">IndexType</span> <span class="n">low_index</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">const</span> <span class="n">IndexType</span> <span class="n">high_index</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">const</span> <span class="n">double</span> <span class="n">delta</span><span class="p">);</span>
</pre></div>
</div>
<p>In the 2D interface, the call is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">initialize</span> <span class="n">a</span> <span class="n">boundary</span> <span class="n">side</span>
<span class="nb">int</span> <span class="n">CRBC2d_init_face</span> <span class="p">(</span><span class="n">CrbcUpdater2d</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                      <span class="n">const</span> <span class="n">CRBC2d_Side_t</span> <span class="n">side</span><span class="p">,</span>
                      <span class="n">const</span> <span class="n">IndexType</span> <span class="n">low_index</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                      <span class="n">const</span> <span class="n">IndexType</span> <span class="n">high_index</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                      <span class="n">const</span> <span class="n">double</span> <span class="n">delta</span><span class="p">);</span>
</pre></div>
</div>
<p>Finally, in the C++ interface, the call is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">init_face</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">&amp;</span><span class="n">side</span><span class="p">,</span>
               <span class="n">const</span> <span class="n">IndexType</span> <span class="n">low_index</span><span class="p">[</span><span class="n">DIM</span><span class="p">],</span>
               <span class="n">const</span> <span class="n">IndexType</span> <span class="n">high_index</span><span class="p">[</span><span class="n">DIM</span><span class="p">],</span>
               <span class="n">const</span> <span class="n">double</span> <span class="o">&amp;</span><span class="n">delta</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="copying-and-updating-values">
<h4>Copying and Updating Values<a class="headerlink" href="#copying-and-updating-values" title="Permalink to this headline">¶</a></h4>
<p>The remaining process of using the library is simply passing information back
and forth. After the solver used to update the interior values has taken a time
step, we need to load the set of points adjacent to the boundary that were updated
by the solver. To do this, we ask the boundary updater object to provide us with
the indexing extents it expects to receive as inputs. Depending on the interface,
this is one of the following calls</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">CRBC_get_input_extents</span> <span class="p">(</span><span class="n">YeeCrbcUpdater</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                     <span class="n">const</span> <span class="n">CRBC_Side_t</span> <span class="n">side</span><span class="p">,</span>
                     <span class="n">const</span> <span class="n">CRBC_Fields_t</span> <span class="n">comp</span><span class="p">,</span>
                     <span class="n">IndexType</span> <span class="n">low</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                     <span class="n">IndexType</span> <span class="n">high</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

<span class="n">void</span> <span class="n">CRBC2d_get_input_extents</span> <span class="p">(</span><span class="n">CrbcUpdater2d</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                     <span class="n">const</span> <span class="n">CRBC2d_Side_t</span> <span class="n">side</span><span class="p">,</span>
                     <span class="n">IndexType</span> <span class="n">low</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                     <span class="n">IndexType</span> <span class="n">high</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

<span class="n">void</span> <span class="n">get_input_extents</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">&amp;</span><span class="n">side</span><span class="p">,</span>
                       <span class="n">IndexType</span> <span class="n">low</span><span class="p">[</span><span class="n">DIM</span><span class="p">],</span>
                       <span class="n">IndexType</span> <span class="n">high</span><span class="p">[</span><span class="n">DIM</span><span class="p">])</span> <span class="n">const</span><span class="p">;</span>
</pre></div>
</div>
<p>Then, we simply copy the values from the solver into the boundary updater object
at these extents using one of the following calls, depending on the interface,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">CRBC_load_face_data</span> <span class="p">(</span><span class="n">YeeCrbcUpdater</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                          <span class="n">const</span> <span class="n">CRBC_Side_t</span> <span class="n">side</span><span class="p">,</span>
                          <span class="n">const</span> <span class="n">CRBC_Fields_t</span> <span class="n">comp</span><span class="p">,</span>
                          <span class="n">const</span> <span class="n">IndexType</span> <span class="n">P</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                          <span class="n">const</span> <span class="n">ScalarType</span> <span class="o">*</span><span class="n">val</span><span class="p">);</span>

<span class="n">void</span> <span class="n">CRBC2d_load_face_data</span> <span class="p">(</span><span class="n">CrbcUpdater2d</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                            <span class="n">const</span> <span class="n">CRBC2d_Side_t</span> <span class="n">side</span><span class="p">,</span>
                            <span class="n">const</span> <span class="n">IndexType</span> <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                            <span class="n">const</span> <span class="n">ScalarType</span> <span class="o">*</span><span class="n">val</span><span class="p">);</span>

<span class="n">void</span> <span class="n">load_face_data</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">&amp;</span><span class="n">side</span><span class="p">,</span>
                    <span class="n">const</span> <span class="n">IndexType</span> <span class="n">P</span><span class="p">[</span><span class="n">DIM</span><span class="p">],</span>
                    <span class="n">const</span> <span class="n">DataType</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">);</span>
</pre></div>
</div>
<p>After doing this on all of the sides with a CRBC/DAB boundary condition, we can
ask the boundary updater object to compute the boundary objects with one of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">CRBC_compute_updates</span> <span class="p">(</span><span class="n">YeeCrbcUpdater</span> <span class="o">*</span><span class="n">U</span><span class="p">);</span>

<span class="nb">int</span> <span class="n">CRBC2d_compute_updates</span> <span class="p">(</span><span class="n">CrbcUpdater2d</span> <span class="o">*</span><span class="n">U</span><span class="p">);</span>

<span class="n">void</span> <span class="n">compute_updates</span><span class="p">();</span>
</pre></div>
</div>
<p>Finally, we need to copy the updated boundary values into the solver. We do this
by asking the boundary updater object for extents it thinks it should output
data for and then copying the values. We note, of the 3D Yee interface, that it
is not necessary to copy the normal <strong>E</strong> field components into the solver because
they should already be correct (we needed the values to handle edges and corners).
This process involves first calling</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">CRBC_get_output_extents</span> <span class="p">(</span><span class="n">YeeCrbcUpdater</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                              <span class="n">const</span> <span class="n">CRBC_Side_t</span> <span class="n">side</span><span class="p">,</span>
                              <span class="n">const</span> <span class="n">CRBC_Fields_t</span> <span class="n">comp</span><span class="p">,</span>
                              <span class="n">IndexType</span> <span class="n">low</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                              <span class="n">IndexType</span> <span class="n">high</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

<span class="n">void</span> <span class="n">CRBC2d_get_output_extents</span> <span class="p">(</span><span class="n">CrbcUpdater2d</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                                <span class="n">const</span> <span class="n">CRBC2d_Side_t</span> <span class="n">side</span><span class="p">,</span>
                                <span class="n">IndexType</span> <span class="n">low</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                <span class="n">IndexType</span> <span class="n">high</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

<span class="n">void</span> <span class="n">get_output_extents</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">&amp;</span><span class="n">side</span><span class="p">,</span>
                        <span class="n">IndexType</span> <span class="n">low</span><span class="p">[</span><span class="n">DIM</span><span class="p">],</span>
                        <span class="n">IndexType</span> <span class="n">high</span><span class="p">[</span><span class="n">DIM</span><span class="p">])</span> <span class="n">const</span><span class="p">;</span>
</pre></div>
</div>
<p>and then copying the values using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ScalarType</span> <span class="n">CRBC_get_new_face_vals</span> <span class="p">(</span><span class="n">YeeCrbcUpdater</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                                   <span class="n">const</span> <span class="n">CRBC_Side_t</span> <span class="n">side</span><span class="p">,</span>
                                   <span class="n">const</span> <span class="n">CRBC_Fields_t</span> <span class="n">comp</span><span class="p">,</span>
                                   <span class="n">const</span> <span class="n">IndexType</span> <span class="n">P</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

<span class="n">ScalarType</span> <span class="n">CRBC2d_get_new_face_vals</span> <span class="p">(</span><span class="n">CrbcUpdater2d</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">CRBC2d_Side_t</span> <span class="n">side</span><span class="p">,</span>
                                     <span class="n">const</span> <span class="n">IndexType</span> <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

<span class="n">DataType</span> <span class="n">get_new_face_vals</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">&amp;</span><span class="n">side</span><span class="p">,</span>
                           <span class="n">const</span> <span class="n">IndexType</span> <span class="n">P</span><span class="p">[</span><span class="n">DIM</span><span class="p">])</span> <span class="n">const</span><span class="p">;</span>
</pre></div>
</div>
<p>This process is repeated every time step.</p>
</div>
<div class="section" id="more-details">
<h4>More Details<a class="headerlink" href="#more-details" title="Permalink to this headline">¶</a></h4>
<p>For more details, please refer to the Doxygen generated documentation &lt;link&gt;;
the documentation contained in the interface header files <code class="docutils literal notranslate"><span class="pre">3d_yee_crbc_api.h</span></code>,
<code class="docutils literal notranslate"><span class="pre">2d_crbc_api.h</span></code>, and <code class="docutils literal notranslate"><span class="pre">crbc_updates.hpp</span></code>; and the <a class="reference internal" href="examples.html"><span class="doc">Examples</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="choice-of-parameters">
<h2>Choice of Parameters<a class="headerlink" href="#choice-of-parameters" title="Permalink to this headline">¶</a></h2>
<p>The boundary conditions in this library have three basic parameters: the wave
speed, <span class="math notranslate nohighlight">\(c\)</span>, a separation parameter, <span class="math notranslate nohighlight">\(\delta\)</span>, and a time parameter,
<span class="math notranslate nohighlight">\(T\)</span>. We use these three parameters to form a single dimensionless parameter</p>
<div class="math notranslate nohighlight">
\[\eta = \frac{\delta}{c T},\]</div>
<p>which we use as a measure of the difficulty of the simulation. The basic idea is
that larger values of <span class="math notranslate nohighlight">\(\eta\)</span> are easier problems and smaller values are
harder problems. For instance, <span class="math notranslate nohighlight">\(\eta \geq 1\)</span> implies that a boundary condition
is unnecessary because a wave cannot impact it in time <span class="math notranslate nohighlight">\(T\)</span>. In the library,
we use values of <span class="math notranslate nohighlight">\(1e-8 \leq \eta \leq 0.1\)</span>. If the calculated value falls
outside of this range, we simply choose <span class="math notranslate nohighlight">\(\eta\)</span> to represent either an
“easier” or “harder” problem as appropriate.</p>
<p>The parameter <span class="math notranslate nohighlight">\(\delta\)</span> should be chosen as the minimum distance
from the boundary to any sources, scatterers, or other inhomogeneities in the
interior of the domain. In general, if this parameter cannot be calculated directly,
a safe option is to compute a lower bound on this distance that is greater than
zero.</p>
<p>In general, the time parameter <span class="math notranslate nohighlight">\(T\)</span> should be chosen to be the total amount
of time that the simulation is being run. However, in cases where all of the
energy is expected to leave the domain quickly, particularly free space simulations,
it is sometimes reasonable to choose a value of <span class="math notranslate nohighlight">\(T\)</span> that is on the order
of the time it will take for all of the energy to leave the domain.</p>
<div class="section" id="tolerance">
<h3>Tolerance<a class="headerlink" href="#tolerance" title="Permalink to this headline">¶</a></h3>
<p>In general, we prefer the tolerance based system provided we have a way to choose
a reasonable tolerance. The tolerance is used to control the reflection coefficient
of the boundary. We have found that this typically provides a reasonable bound
on the relative error and is, therefore, generally better
than simply guessing an appropriate number of recursions to use.</p>
<p>As a simple rule, it is best to choose a tolerance that is on the order of the
discretization/dispersion error for the length of the simulation. The reason for
this is that the accuracy of the boundary condition has little impact if it is
more accurate than the discretization error in the interior. Conversely, if the
boundary condition is less accurate than the interior, the error from the boundary
condition will dominate. That being said, it is often difficult to determine such
a tolerance before running simulations.</p>
</div>
<div class="section" id="number-of-recursions">
<h3>Number of Recursions<a class="headerlink" href="#number-of-recursions" title="Permalink to this headline">¶</a></h3>
<p>With all else remaining equal, letting the number of recursions go to infinity
will result in an analytically exact boundary condition. In computations, this
is, of course, impossible. We have set the default number of recursions to be
5. We have chosen this primarily because this has seemed to be a good choice
in a majority of our experiments.  Additionally, it is roughly comparable in
computational work to a PML of 10 cells. For a typical simulation, using 5 recursions usually
gives a reflection coefficient that is <span class="math notranslate nohighlight">\(\mathcal{O}(10^{-3})\)</span> or better (with variations
depending on the particular problem). Choosing fewer recursions will be less accurate
but the computational expense will be less. Choosing more recursions requires
more work, but results in greater accuracy.</p>
<p>For reference, the work scales
linearly in the number of recursions on the faces, quadratically on the edges,
and cubically on the corners.
The net result is that work scales linearly on a sufficiently large computational
domain (e.g. there are many more points on a face than the number of recursions).</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/YeeCRBC/gen_use.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
    <a href="../contrib.html">rbcpack Contributors </a><br />
        &copy; Copyright 2015-2016, rbcpack.org.<br/>
    </p>
  </div>
</footer>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-71984541-1', 'auto');
  ga('send', 'pageview');

</script>


  </body>
</html>